%!PS-Adobe-2.0 EPSF-1.2
%%Title: TreePlot
%%Creator: treeplot.c
%%CreationDate: Fri Sep 29 18:04:32 2017
%%BoundingBox: 72 144 522 700
%%EndComments
%%BeginProlog
/treedict 100 dict def
treedict begin
% x y  => min(x,y)
  /min { 2 copy gt { exch } if pop } bind def
  /max { 2 copy lt { exch } if pop } bind def
  /cmtx matrix currentmatrix def
  /STR 128 string def
  /NumH 1 def
% - => -
  /Init {
    /LX [
      LEAF {0 get} forall
    ] def

    /Helvetica findfont fsize scalefont setfont
    /Lo [
      (X) stringwidth pop % width
      newpath 0 0 moveto
      (X) true charpath
      flattenpath pathbbox
      pop exch pop exch sub neg 2 div % height
     ] def
  } def
% - => -
  /DrawScale {
  gsave 
    maxy miny sub 30 div dup maxy add /maxy exch def miny sub /miny def
    maxy miny sub log 0.9 sub floor 10 exch exp /tick exch def
    newpath
    LEAF length 0.5 sub 0 translate 0 miny moveto 0 maxy miny sub rlineto
    miny tick div ceiling tick mul dup 0 exch moveto 
    maxy exch sub tick div cvi 1 add dup { % draw minor ticks
      0.15 0 rlineto
      -0.15 tick rmoveto
    } repeat
    % calculate major tick spacing (10, 5, or 2 minor ticks)
    dup 69 gt { pop 10
    } {
      32 gt { 5 }
      {2} ifelse
    } ifelse
    tick mul /mtick exch def
    miny mtick div ceiling mtick mul dup 0 exch moveto
    maxy exch sub mtick div cvi 1 add {
      0.3 0 rlineto 
      gsave currentpoint 10 mul round 10 div cmtx setmatrix
      STR cvs dup stringwidth pop
      Lo aload pop 3 1 roll add neg exch rmoveto show pop
      grestore
      -0.3 mtick rmoveto
    } repeat
    cmtx setmatrix stroke    
  grestore
  } def
% - => -
  /SetBarFont {
    matrix currentmatrix cmtx setmatrix
    /Helvetica findfont fbsize scalefont setfont
    setmatrix
  } bind def
% - => -
  /SetLabelFont {
    matrix currentmatrix cmtx setmatrix
    /Courier findfont fsize scalefont setfont
    setmatrix
  } bind def
% str => -
  /Rotshow {
    gsave
      dup type () type eq
      { 1 0 0 setrgbcolor }
      { STR cvs }ifelse
      cmtx setmatrix -90 rotate
      Lo aload pop
      rmoveto show
    grestore
  } def
% dy => - 
  /Rlineto {
    dup abs MinHeight ge { % draw height at middle of line
      dup gsave
	dup 2 div 0 exch rmoveto
	cmtx setmatrix -90 rotate
	abs STR cvs dup stringwidth pop 2 div neg
	//NumH rmoveto
	show
      grestore
    } if
    0 exch rlineto
  } def
% - => -
  /Drawlabels {
   0 LEAF {
      aload pop moveto
      dup LABEL exch get Rotshow
      1 add
    } forall pop
  } def
% n => n'    Detect whether a minimum is connected
  /MRX {
     /murxi { true } def
     dup 0 lt { pop 0 /murxi { false } def } if
  } def
% - => -
  /Connectlmins {
    newpath
    SADDEL {
      /forest {false} def  %  draw as tree or forest node
      aload pop exch dup 0 lt { pop 0 /forest {true} def} if   % => c h f
      dup LX exch get [ exch LX 5 index get add 2 div % => c h f [ nx
      3 index ]				         % => c h f [ nx h ]
      3 -1 roll dup LEAF 6 -1 roll get aload pop % => f [nx h] h h cx cy
      dup 3 1 roll moveto		         % => f [] h h cy
      sub Rlineto                                % => f [] h
      LEAF 3 index get aload pop exch		 % => f [] h fy fx
      2 index forest {moveto} {lineto} ifelse 
      sub neg Rlineto			         % => f [] h fy
      LEAF 3 1 roll put
    } forall
    gsave
      cmtx setmatrix stroke
    grestore
  } def
% data starts here!!!
  /LABEL [
   (1)   2   3   4   5   6   7   8   9  10 
    11  12  13  14  15  16  17  18  19  20 
    21  22  23  24  25  26  27  28  29  30 
    31  32  33  34  35  36  37  38  39  40 
    41  42  43  44  45  46 (47)  48  49  50 
    51  52 (53)  54  55  56  57  58  59  60 
    61 (62)  63  64  65 (66)  67  68  69  70 
    71  72  73 (74)  75  76  77  78  79  80 
    81  82  83  84  85  86  87  88  89  90 
    91  92  93  94  95  96  97  98  99 (100) 
  ] def
% leaf node coordinates
  /LEAF [
   [0    -7.200] [7    -7.200] [20   -6.800] [21   -4.500] [8    -4.300] 
   [9    -3.300] [23   -3.000] [28   -2.300] [29   -1.600] [22   -1.400] 
   [11   -1.300] [25   -1.000] [13   -0.800] [41   -0.800] [26   -0.600] 
   [14   -0.600] [30   -0.400] [24   -0.300] [10   -0.200] [37    0.000] 
   [27    0.400] [12    0.500] [31    0.500] [39    0.700] [42    0.800] 
   [35    0.900] [38    0.900] [32    1.100] [43    1.100] [49    1.400] 
   [33    1.500] [59    1.500] [46    1.600] [34    1.700] [36    1.800] 
   [40    1.900] [54    1.900] [47    1.900] [15    2.000] [45    2.000] 
   [16    2.100] [62    2.100] [44    2.200] [18    2.300] [60    2.300] 
   [52    2.400] [1     2.500] [17    2.500] [57    2.600] [76    2.700] 
   [48    2.700] [19    2.800] [2     2.800] [50    2.800] [80    2.800] 
   [58    2.800] [67    2.900] [90    3.000] [55    3.100] [71    3.200] 
   [70    3.200] [3     3.200] [51    3.200] [68    3.300] [56    3.400] 
   [4     3.400] [53    3.400] [61    3.400] [97    3.500] [72    3.500] 
   [77    3.500] [81    3.600] [86    3.600] [5     3.700] [65    3.700] 
   [63    3.800] [91    3.800] [66    3.800] [98    3.800] [74    3.800] 
   [73    3.800] [69    3.800] [64    3.900] [84    3.900] [87    3.900] 
   [82    4.000] [85    4.100] [88    4.100] [83    4.100] [78    4.200] 
   [92    4.200] [75    4.200] [99    4.300] [89    4.300] [79    4.300] 
   [93    4.300] [96    4.400] [95    4.400] [94    4.400] [6     4.400]   
] def
% internal nodes (saddle) coordinates, sorted by height
  /SADDEL [
   [  4   1  -2.100] [  5   1  -2.100] [  3   2  -1.700] [  9   2  -0.600] 
   [  6   2  -0.200] [  8   7   0.100] [ 17   2   0.100] [ 11   2   0.200] 
   [ 18   1   0.200] [ 16   7   0.300] [ 14   2   0.500] [ 10   1   0.600] 
   [ 20   2   1.000] [ 21   1   1.000] [  7   2   1.200] [ 22   2   1.300] 
   [ 27   2   1.500] [ 24  13   1.800] [ 28  13   1.800] [ 30   2   2.000] 
   [ 33   2   2.000] [ 26  19   2.100] [ 15  12   2.300] [ 25   2   2.300] 
   [ 23  19   2.400] [ 38  12   2.500] [ 35  19   2.600] [ 12   1   2.700] 
   [ 34   2   2.700] [ 19   2   2.800] [ 40   1   2.800] [ 42  13   2.900] 
   [ 47   1   2.900] [ 46   0   2.900] [ 13   2   3.000] [ 39   2   3.100] 
   [ 43   1   3.100] [ 32   2   3.200] [ 37   2   3.200] [ 51   1   3.300] 
   [  2   1   3.400] [ 50   1   3.400] [ 29   1   3.500] [ 53   1   3.500] 
   [ 52   0   3.500] [ 62   1   3.600] [ 61   0   3.600] [ 45   1   3.800] 
   [ 66   1   3.800] [ 65   0   3.800] [ 36   1   3.900] [ 58   1   3.900] 
   [ 64   1   3.900] [ 78  68   3.900] [ 44  31   4.000] [ 48   1   4.100] 
   [ 55   1   4.100] [ 67  31   4.100] [ 76  57   4.200] [ 31   1   4.300] 
   [ 41   1   4.300] [ 75   1   4.300] [ 82   1   4.300] [ 63  56   4.400] 
   [ 74   1   4.400] [ 73   0   4.400] [ 81  56   4.500] [ 77   1   4.500] 
   [ 56   1   4.600] [ 60   1   4.600] [ 59   1   4.600] [ 69   1   4.600] 
   [ 71  54   4.600] [ 80   1   4.600] [ 79   1   4.600] [ 91   1   4.600] 
   [ 49   1   4.700] [ 70   1   4.700] [ 89   1   4.700] [ 94   1   4.700] 
   [ 54   1   4.800] [ 85   1   4.800] [ 88   1   4.800] [ 83   1   4.900] 
   [ 86   1   4.900] [ 72   1   5.000] [ 84   1   5.000] [ 87   1   5.000] 
   [ 93   1   5.000] [ 57   1   5.100] [ 90   1   5.400] [ 95   1   5.400] 
   [ 98   1   5.400] [ 97   1   5.400] [ 96   1   5.400] [ 68   1   5.700] 
   [ 92   1   6.000] [ 99   0   6.200] [  1  -1  12.801] [  0  -1  12.801]   
] def
end
%%EndProlog
treedict begin
  /fsize 10 def
  /fbsize 7 def
  Init
  521 144 fsize 1.5 mul add translate
  72 521 sub LEAF length div % x-scale
  699 144 fsize dup add add sub
  SADDEL dup length 1 sub get 2 get /maxy exch def % max height
  9999999 LEAF { aload pop exch pop min } forall
  /miny exch def % min height
  maxy miny sub dup 20 div /MinHeight exch def
  div scale
  .5 LEAF 0 get 1 get neg translate
  SetLabelFont
  Drawlabels
  DrawScale
  SetBarFont
  Connectlmins
  showpage
end
%%EOF
